---
import { getAuditContent, type Challenge } from '../../lib/content-utils';

// Load content from JSON file (editable via /dev/editor)
const content = getAuditContent();

interface Props {
  title?: string;
  highlightText?: string;
  description?: string;
  challenges?: Challenge[];
}

// Props can still override JSON defaults
const {
  title = content.title,
  highlightText = content.highlightText,
  description = content.description,
  challenges = content.challenges
} = Astro.props;
---

<section class="overflow-hidden">
  <div class="py-16 md:py-24 lg:py-32 pb-0">
    <div class="px-4 md:px-8 lg:px-12">
      <div class="max-w-7xl mx-auto">

        <!-- Header -->
        <div class="max-w-xs md:max-w-none mx-auto md:mx-0 md:text-left text-center">
          <h2 class="text-4xl md:text-5xl lg:text-6xl font-medium text-surface-900">
            {title} <span class="text-surface-400">{highlightText}</span>
          </h2>
        </div>

        <div class="h-4"></div>

        <!-- Description -->
        <div class="max-w-xl mx-auto md:mx-0 md:text-left text-center">
          <p class="text-surface-600 text-lg">{description}</p>
        </div>

        <div class="h-12 md:h-16"></div>

        <!-- Feature Cards Grid with full-width overflow -->
        <div class="audit-overflow-wrapper border-y border-surface-200">
          <div class="grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 gap-px bg-surface-200">
            {challenges.map((challenge) => (
              <div class="bg-white py-12 md:py-20 px-6 md:px-8 text-center">
                <div class="flex justify-center">
                  <img
                    src={challenge.icon}
                    loading="lazy"
                    width="64"
                    height="64"
                    alt={challenge.iconAlt}
                    class="w-16 h-16"
                  />
                </div>
                <div class="h-4"></div>
                <h3 class="text-xl font-bold text-surface-900">{challenge.title}</h3>
                <div class="h-2"></div>
                <p class="text-surface-600 leading-relaxed">{challenge.description}</p>
              </div>
            ))}
          </div>
        </div>

      </div>
    </div>
  </div>
</section>

<style>
  /* Full-width overflow effect - extends beyond container */
  .audit-overflow-wrapper {
    margin-left: calc(-50vw + 50%);
    margin-right: calc(-50vw + 50%);
    padding-left: calc(50vw - 50%);
    padding-right: calc(50vw - 50%);
  }

  @media (max-width: 767px) {
    .audit-overflow-wrapper {
      margin-left: -1rem;
      margin-right: -1rem;
      padding-left: 0;
      padding-right: 0;
    }
  }
</style>
